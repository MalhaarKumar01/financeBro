<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FINANCEBRO // VALUATION TERMINAL</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Bebas+Neue&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">FINANCE<span>BRO</span></div>
            <div class="subtitle">Valuation Terminal // P/E & PEG Analysis</div>
            <div class="timestamp" id="timestamp">LOADING...</div>
        </header>

        <div class="main-grid">
            <!-- Exchange Tabs -->
            <div class="exchange-tabs">
                <button class="tab-btn active" data-exchange="nyse">
                    <span class="tab-label">NYSE</span>
                    <span class="tab-flag">ðŸ‡ºðŸ‡¸</span>
                    <span class="tab-count" id="count-nyse">30 STOCKS</span>
                </button>
                <button class="tab-btn" data-exchange="tsx">
                    <span class="tab-label">TSX</span>
                    <span class="tab-flag">ðŸ‡¨ðŸ‡¦</span>
                    <span class="tab-count" id="count-tsx">40 STOCKS</span>
                </button>
                <button class="tab-btn" data-exchange="nse">
                    <span class="tab-label">NSE</span>
                    <span class="tab-flag">ðŸ‡®ðŸ‡³</span>
                    <span class="tab-count" id="count-nse">5 STOCKS</span>
                </button>
                <button class="tab-btn" data-exchange="crypto">
                    <span class="tab-label">CRYPTO</span>
                    <span class="tab-flag">â‚¿</span>
                    <span class="tab-count" id="count-crypto">10 COINS</span>
                </button>
                <button class="tab-btn" data-exchange="etf">
                    <span class="tab-label">ETF</span>
                    <span class="tab-flag">ðŸ“Š</span>
                    <span class="tab-count" id="count-etf">10 FUNDS</span>
                </button>
                <div class="tab-info">
                    <span id="current-exchange">NYSE</span> // <span id="stock-count">30</span> SECURITIES LOADED
                </div>
                <div class="api-status" id="api-status">
                    <span class="status-indicator"></span>
                    <span class="status-text">CONNECTING...</span>
                </div>
            </div>

            <!-- Power Search Bar -->
            <div class="power-search-container">
                <div class="search-bar">
                    <div class="search-input-wrapper">
                        <span class="search-prefix">></span>
                        <input type="text" id="stock-search" placeholder="SEARCH: ticker:AAPL | pe<20 | peg>1 | industry:Tech | sort:pe">
                        <span class="search-shortcut">CTRL+K</span>
                    </div>
                    <div class="filter-btns">
                        <button class="filter-btn active" data-filter="all">ALL</button>
                        <button class="filter-btn" data-filter="undervalued">UNDERVALUED</button>
                        <button class="filter-btn" data-filter="fair">FAIR</button>
                        <button class="filter-btn" data-filter="overvalued">OVERVALUED</button>
                    </div>
                </div>
                <div class="sort-controls">
                    <span class="sort-label">SORT:</span>
                    <button class="sort-btn active" data-sort="ticker">TICKER</button>
                    <button class="sort-btn" data-sort="pe-asc">P/E â†‘</button>
                    <button class="sort-btn" data-sort="pe-desc">P/E â†“</button>
                    <button class="sort-btn" data-sort="peg-asc">PEG â†‘</button>
                    <button class="sort-btn" data-sort="peg-desc">PEG â†“</button>
                    <button class="sort-btn" data-sort="price-asc">PRICE â†‘</button>
                    <button class="sort-btn" data-sort="price-desc">PRICE â†“</button>
                    <button class="sort-btn" data-sort="change-desc">CHANGE â†“</button>
                    <span class="index-display" id="index-display">IDX: 001-010</span>
                </div>
                <div class="search-help">
                    <span class="help-tag">SYNTAX:</span>
                    <code>ticker:XYZ</code>
                    <code>pe&lt;20</code>
                    <code>pe&gt;10</code>
                    <code>peg&lt;1</code>
                    <code>growth&gt;15</code>
                    <code>industry:Tech</code>
                </div>
            </div>

            <!-- Industry Filter -->
            <div class="industry-bar">
                <div class="industry-label">SECTOR:</div>
                <div class="industry-btns" id="industry-btns">
                    <button class="industry-btn active" data-industry="all">ALL</button>
                    <button class="industry-btn" data-industry="Technology">TECH</button>
                    <button class="industry-btn" data-industry="Defence">DEFENCE</button>
                    <button class="industry-btn" data-industry="Financials">FINANCIALS</button>
                    <button class="industry-btn" data-industry="Healthcare">HEALTHCARE</button>
                    <button class="industry-btn" data-industry="Energy">ENERGY</button>
                    <button class="industry-btn" data-industry="Industrials">INDUSTRIALS</button>
                    <button class="industry-btn" data-industry="Consumer Cyclical">CONSUMER</button>
                    <button class="industry-btn" data-industry="Consumer Defensive">STAPLES</button>
                    <button class="industry-btn" data-industry="Materials">MATERIALS</button>
                    <button class="industry-btn" data-industry="Utilities">UTILITIES</button>
                    <button class="industry-btn" data-industry="Telecom">TELECOM</button>
                    <button class="industry-btn" data-industry="Real Estate">REAL ESTATE</button>
                </div>
            </div>

            <div class="section-header">
                <h2>STOCK VALUATIONS</h2>
            </div>

            <!-- Stock Grid Container -->
            <div class="stock-grid" id="stock-grid">
                <!-- Stocks will be rendered here by JavaScript -->
            </div>

            <!-- Pagination -->
            <div class="pagination" id="pagination">
                <!-- Pagination buttons rendered by JS -->
            </div>

            <!-- Terminal Footer -->
            <div class="terminal-footer">
                <div class="terminal-line">System initialized: <span>FINANCEBRO v5.0 // YFINANCE EDITION</span></div>
                <div class="terminal-line">Data sources: <span>YFINANCE API // REAL-TIME DATA // FREE TIER</span></div>
                <div class="terminal-line">Analysis complete: <span id="stats-line">50 stocks processed // 250 metrics evaluated</span></div>
                <div class="terminal-line">Keyboard: <span>CTRL+K search | CTRL+1-5 exchange | CTRL+R refresh | ESC clear</span></div>
                <div class="terminal-line">Status: <span class="status-ready">READY FOR ANALYSIS</span></div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // API CONFIGURATION
        // ============================================
        const API_BASE = 'http://localhost:5001';
        let stockData = { nyse: [], tsx: [], nse: [], crypto: [], etf: [] };
        let isLoading = false;
        let apiConnected = false;

        // Exchange metadata
        const exchangeInfo = {
            nyse: { currency: '$', name: 'NYSE', country: 'USA', flag: 'ðŸ‡ºðŸ‡¸' },
            tsx: { currency: 'C$', name: 'TSX', country: 'Canada', flag: 'ðŸ‡¨ðŸ‡¦' },
            nse: { currency: 'â‚¹', name: 'NSE', country: 'India', flag: 'ðŸ‡®ðŸ‡³' },
            crypto: { currency: '$', name: 'CRYPTO', country: 'Global', flag: 'â‚¿' },
            etf: { currency: '$', name: 'ETF', country: 'USA', flag: 'ðŸ“Š' }
        };

        // ============================================
        // API FUNCTIONS
        // ============================================
        async function fetchStockData(exchange) {
            try {
                const response = await fetch(`${API_BASE}/api/stocks/${exchange}`);
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                const data = await response.json();
                return data.stocks || [];
            } catch (error) {
                console.error(`Error fetching ${exchange}:`, error);
                return [];
            }
        }

        async function loadAllData() {
            isLoading = true;
            updateApiStatus('loading', 'FETCHING DATA...');
            showLoading();

            try {
                // Fetch all exchanges in parallel
                const [nyse, tsx, nse, crypto, etf] = await Promise.all([
                    fetchStockData('nyse'),
                    fetchStockData('tsx'),
                    fetchStockData('nse'),
                    fetchStockData('crypto'),
                    fetchStockData('etf')
                ]);

                stockData = { nyse, tsx, nse, crypto, etf };
                apiConnected = true;

                // Update counts
                document.getElementById('count-nyse').textContent = `${nyse.length} STOCKS`;
                document.getElementById('count-tsx').textContent = `${tsx.length} STOCKS`;
                document.getElementById('count-nse').textContent = `${nse.length} STOCKS`;
                document.getElementById('count-crypto').textContent = `${crypto.length} COINS`;
                document.getElementById('count-etf').textContent = `${etf.length} FUNDS`;

                updateApiStatus('connected', 'LIVE DATA');
                renderStocks();

            } catch (error) {
                console.error('Failed to load data:', error);
                apiConnected = false;
                updateApiStatus('error', 'API OFFLINE');
                showError();
            }

            isLoading = false;
        }

        function updateApiStatus(status, text) {
            const statusEl = document.getElementById('api-status');
            statusEl.className = `api-status ${status}`;
            statusEl.querySelector('.status-text').textContent = text;
        }

        function showLoading() {
            document.getElementById('stock-grid').innerHTML = `
                <div class="loading-state">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">FETCHING LIVE DATA FROM YFINANCE...</div>
                </div>
            `;
        }

        function showError() {
            document.getElementById('stock-grid').innerHTML = `
                <div class="error-state">
                    <div class="error-icon">âš </div>
                    <div class="error-text">API OFFLINE</div>
                    <div class="error-hint">Start the API server: python api.py</div>
                    <button class="retry-btn" onclick="loadAllData()">RETRY CONNECTION</button>
                </div>
            `;
        }

        // Auto-refresh data every 60 seconds
        function startAutoRefresh() {
            setInterval(() => {
                if (apiConnected && !isLoading) {
                    loadAllData();
                }
            }, 60000);
        }

        // ============================================
        // STATE
        // ============================================
        let currentExchange = 'nyse';
        let currentFilter = 'all';
        let currentIndustry = 'all';
        let searchQuery = '';
        let currentPage = 1;
        let currentSort = 'ticker';
        const stocksPerPage = 12;

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        function getValuation(peg) {
            if (peg < 1) return { label: 'UNDERVALUED', class: 'highlight-good', filter: 'undervalued' };
            if (peg <= 2) return { label: 'FAIR VALUE', class: 'highlight-warn', filter: 'fair' };
            return { label: 'OVERVALUED', class: 'highlight-bad', filter: 'overvalued' };
        }

        function getPeComparison(pe, industryPe) {
            const diff = ((pe - industryPe) / industryPe * 100).toFixed(0);
            if (diff < -5) return { text: `${diff}% vs IND`, class: 'highlight-good' };
            if (diff <= 10) return { text: `+${diff}% vs IND`, class: 'highlight-warn' };
            return { text: `+${diff}% vs IND`, class: 'highlight-bad' };
        }

        // ============================================
        // POWER SEARCH PARSER
        // ============================================
        function parseAdvancedSearch(query) {
            const result = {
                text: '',
                ticker: null,
                peMin: null,
                peMax: null,
                pegMin: null,
                pegMax: null,
                growthMin: null,
                growthMax: null,
                industry: null
            };

            // Split by pipe or space for multiple conditions
            const parts = query.split(/[\|\s]+/).filter(p => p.trim());

            parts.forEach(part => {
                const trimmed = part.trim().toLowerCase();

                // ticker:XYZ
                if (trimmed.startsWith('ticker:')) {
                    result.ticker = trimmed.replace('ticker:', '').toUpperCase();
                }
                // pe<20 or pe>10
                else if (trimmed.match(/^pe[<>]/)) {
                    const match = trimmed.match(/^pe([<>])(\d+\.?\d*)/);
                    if (match) {
                        if (match[1] === '<') result.peMax = parseFloat(match[2]);
                        else result.peMin = parseFloat(match[2]);
                    }
                }
                // peg<1 or peg>2
                else if (trimmed.match(/^peg[<>]/)) {
                    const match = trimmed.match(/^peg([<>])(\d+\.?\d*)/);
                    if (match) {
                        if (match[1] === '<') result.pegMax = parseFloat(match[2]);
                        else result.pegMin = parseFloat(match[2]);
                    }
                }
                // growth>15 or growth<30
                else if (trimmed.match(/^growth[<>]/)) {
                    const match = trimmed.match(/^growth([<>])(\d+\.?\d*)/);
                    if (match) {
                        if (match[1] === '<') result.growthMax = parseFloat(match[2]);
                        else result.growthMin = parseFloat(match[2]);
                    }
                }
                // industry:Tech
                else if (trimmed.startsWith('industry:')) {
                    result.industry = part.replace(/industry:/i, '');
                }
                // Regular text search
                else if (!trimmed.startsWith('sort:')) {
                    result.text += (result.text ? ' ' : '') + trimmed;
                }
            });

            return result;
        }

        function matchesAdvancedSearch(stock, criteria) {
            // Text search
            if (criteria.text && !stock.ticker.toLowerCase().includes(criteria.text) &&
                !stock.name.toLowerCase().includes(criteria.text)) {
                return false;
            }
            // Ticker exact match
            if (criteria.ticker && !stock.ticker.toUpperCase().includes(criteria.ticker)) {
                return false;
            }
            // PE filters
            if (criteria.peMin !== null && stock.pe < criteria.peMin) return false;
            if (criteria.peMax !== null && stock.pe > criteria.peMax) return false;
            // PEG filters
            if (criteria.pegMin !== null && stock.peg < criteria.pegMin) return false;
            if (criteria.pegMax !== null && stock.peg > criteria.pegMax) return false;
            // Growth filters
            if (criteria.growthMin !== null && stock.growth < criteria.growthMin) return false;
            if (criteria.growthMax !== null && stock.growth > criteria.growthMax) return false;
            // Industry filter
            if (criteria.industry && !stock.industry.toLowerCase().includes(criteria.industry.toLowerCase())) {
                return false;
            }
            return true;
        }

        // ============================================
        // SORTING FUNCTION
        // ============================================
        function sortStocks(stocks) {
            const sorted = [...stocks];
            switch (currentSort) {
                case 'ticker':
                    sorted.sort((a, b) => a.ticker.localeCompare(b.ticker));
                    break;
                case 'pe-asc':
                    sorted.sort((a, b) => a.pe - b.pe);
                    break;
                case 'pe-desc':
                    sorted.sort((a, b) => b.pe - a.pe);
                    break;
                case 'peg-asc':
                    sorted.sort((a, b) => a.peg - b.peg);
                    break;
                case 'peg-desc':
                    sorted.sort((a, b) => b.peg - a.peg);
                    break;
                case 'price-asc':
                    sorted.sort((a, b) => a.price - b.price);
                    break;
                case 'price-desc':
                    sorted.sort((a, b) => b.price - a.price);
                    break;
                case 'change-desc':
                    sorted.sort((a, b) => b.change - a.change);
                    break;
            }
            return sorted;
        }

        // ============================================
        // RENDER FUNCTIONS
        // ============================================
        function renderStocks() {
            const stocks = stockData[currentExchange];
            const searchCriteria = parseAdvancedSearch(searchQuery);

            // Apply filters
            let filtered = stocks.filter(stock => {
                // Advanced search filter
                if (!matchesAdvancedSearch(stock, searchCriteria)) return false;

                // Valuation filter
                const valuation = getValuation(stock.peg);
                const matchesFilter = currentFilter === 'all' || valuation.filter === currentFilter;

                // Industry filter (from buttons)
                const matchesIndustry = currentIndustry === 'all' || stock.industry === currentIndustry;

                return matchesFilter && matchesIndustry;
            });

            // Apply sorting
            filtered = sortStocks(filtered);

            // Pagination
            const totalPages = Math.ceil(filtered.length / stocksPerPage);
            const start = (currentPage - 1) * stocksPerPage;
            const paginatedStocks = filtered.slice(start, start + stocksPerPage);

            // Update index display
            const endIdx = Math.min(start + stocksPerPage, filtered.length);
            document.getElementById('index-display').textContent =
                `IDX: ${String(start + 1).padStart(3, '0')}-${String(endIdx).padStart(3, '0')} / ${filtered.length}`;

            // Get exchange info
            const info = exchangeInfo[currentExchange];

            // Render stock cards
            const grid = document.getElementById('stock-grid');
            grid.innerHTML = paginatedStocks.map((stock, index) => {
                const valuation = getValuation(stock.peg);
                const peComparison = getPeComparison(stock.pe, stock.industryPe);
                const changeClass = stock.change >= 0 ? 'up' : 'down';
                const changeSign = stock.change >= 0 ? '+' : '';
                const globalIdx = String(start + index + 1).padStart(3, '0');

                return `
                    <div class="stock-card" data-rank="${globalIdx}">
                        <div class="card-header">
                            <div>
                                <div class="ticker">${stock.ticker}</div>
                                <div class="company-name">${stock.name}</div>
                            </div>
                            <div class="price-tag">
                                <div class="current-price">${info.currency}${stock.price.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</div>
                                <div class="price-change ${changeClass}">${changeSign}${stock.change.toFixed(2)}%</div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="metric-row">
                                <span class="metric-label">P/E Ratio (TTM)</span>
                                <span class="metric-value ${peComparison.class}">${stock.pe.toFixed(2)}<span class="vs-industry">${peComparison.text}</span></span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label">Forward P/E</span>
                                <span class="metric-value">${stock.forwardPe.toFixed(2)}</span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label">PEG Ratio</span>
                                <span class="metric-value ${valuation.class}">${stock.peg.toFixed(2)}<span class="vs-industry">${valuation.label}</span></span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label">52-Week High</span>
                                <span class="metric-value">${info.currency}${stock.week52High.toFixed(2)}<span class="vs-industry ${stock.pctFromHigh >= 0 ? 'highlight-good' : 'highlight-bad'}">${stock.pctFromHigh.toFixed(1)}%</span></span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label">52-Week Low</span>
                                <span class="metric-value">${info.currency}${stock.week52Low.toFixed(2)}<span class="vs-industry ${stock.pctFromLow >= 20 ? 'highlight-good' : stock.pctFromLow >= 0 ? 'highlight-warn' : 'highlight-bad'}">${stock.pctFromLow > 0 ? '+' : ''}${stock.pctFromLow.toFixed(1)}%</span></span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label">5Y EPS Growth</span>
                                <span class="metric-value">${stock.growth.toFixed(1)}%</span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label">Industry Avg P/E</span>
                                <span class="metric-value" style="color: rgba(240,240,232,0.5)">${stock.industryPe.toFixed(2)}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            // Render pagination
            renderPagination(totalPages, filtered.length);

            // Update stats
            document.getElementById('stock-count').textContent = filtered.length;
            document.getElementById('current-exchange').textContent = info.name;

            // Calculate total stocks across all exchanges
            const totalStocks = Object.values(stockData).reduce((sum, arr) => sum + arr.length, 0);
            document.getElementById('stats-line').textContent =
                `${filtered.length} stocks displayed // ${totalStocks} total // ${filtered.length * 5} metrics`;
        }

        function renderPagination(totalPages, totalStocks) {
            const pagination = document.getElementById('pagination');

            if (totalPages <= 1) {
                pagination.innerHTML = `<span class="page-info">SHOWING ALL ${totalStocks} RESULTS</span>`;
                return;
            }

            let html = `<span class="page-info">PAGE ${currentPage} OF ${totalPages} // ${totalStocks} RESULTS</span>`;
            html += '<div class="page-btns">';

            if (currentPage > 1) {
                html += `<button class="page-btn" data-page="${currentPage - 1}">&lt; PREV</button>`;
            }

            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) {
                    html += `<button class="page-btn ${i === currentPage ? 'active' : ''}" data-page="${i}">${i}</button>`;
                } else if (i === currentPage - 2 || i === currentPage + 2) {
                    html += '<span class="page-dots">...</span>';
                }
            }

            if (currentPage < totalPages) {
                html += `<button class="page-btn" data-page="${currentPage + 1}">NEXT &gt;</button>`;
            }

            html += '</div>';
            pagination.innerHTML = html;

            // Add click handlers
            pagination.querySelectorAll('.page-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    currentPage = parseInt(btn.dataset.page);
                    renderStocks();
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            });
        }

        // ============================================
        // EVENT LISTENERS
        // ============================================
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentExchange = btn.dataset.exchange;
                currentPage = 1;
                renderStocks();
            });
        });

        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentFilter = btn.dataset.filter;
                currentPage = 1;
                renderStocks();
            });
        });

        document.getElementById('stock-search').addEventListener('input', (e) => {
            searchQuery = e.target.value;
            currentPage = 1;
            renderStocks();
        });

        document.querySelectorAll('.industry-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.industry-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentIndustry = btn.dataset.industry;
                currentPage = 1;
                renderStocks();
            });
        });

        // Sort buttons
        document.querySelectorAll('.sort-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.sort-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentSort = btn.dataset.sort;
                currentPage = 1;
                renderStocks();
            });
        });

        // ============================================
        // KEYBOARD SHORTCUTS (Power User)
        // ============================================
        document.addEventListener('keydown', (e) => {
            // Ctrl+K - Focus search
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                document.getElementById('stock-search').focus();
            }
            // Ctrl+1-5 - Switch exchanges
            if ((e.ctrlKey || e.metaKey) && e.key >= '1' && e.key <= '5') {
                e.preventDefault();
                const exchanges = ['nyse', 'tsx', 'nse', 'crypto', 'etf'];
                const idx = parseInt(e.key) - 1;
                if (idx < exchanges.length) {
                    currentExchange = exchanges[idx];
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelector(`[data-exchange="${exchanges[idx]}"]`).classList.add('active');
                    currentPage = 1;
                    renderStocks();
                }
            }
            // Ctrl+R - Refresh data
            if ((e.ctrlKey || e.metaKey) && e.key === 'r') {
                e.preventDefault();
                loadAllData();
            }
            // Escape - Clear search
            if (e.key === 'Escape') {
                document.getElementById('stock-search').value = '';
                searchQuery = '';
                currentPage = 1;
                renderStocks();
                document.getElementById('stock-search').blur();
            }
        });

        // ============================================
        // TIMESTAMP
        // ============================================
        function updateTime() {
            const now = new Date();
            const options = {
                weekday: 'short',
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            };
            document.getElementById('timestamp').textContent = now.toLocaleDateString('en-US', options).toUpperCase();
        }
        updateTime();
        setInterval(updateTime, 1000);

        // ============================================
        // INITIALIZE
        // ============================================
        loadAllData();
        startAutoRefresh();
    </script>
</body>
</html>

